
<div class="pt-1 px-4" *ngIf="(certificados && certificados.length && !loading)">
    <div class="row">
        <div class="col-md-5 col-sm-12">
            <p class="fs-5">Certificados a generar: <span class="fw-bolder">{{certificados.length}}</span></p>
        </div>
        <div class="col-md-7">
            <button class="btn btn-sm btn-primary float-end" (click)="generarCertificados()" [disabled]="loading">Generar Certificados</button>
        </div>
    </div>
    <hr>
    <div class="mb-4">
        <span>Detalle: </span>
        <div class="float-end">
            <button class="btn btn-light" (click)="hideOrShowAll(true)">Ocultar todo</button>
            <button class="btn btn-light" (click)="hideOrShowAll(false)">Expandir todo</button>
        </div>
    </div>
    <div class="row">
        <div *ngFor="let certificado of certificados; index as i" class="col-xl-4 col-md-6 col-sm-12 mb-2">
            <div class="mb-2 card">
                <div class="card-header px-1 pointer" (click)="toggleHidden(i)">
                    <button class="btn btn-link collapseButton" > <fa-icon [icon]="!certificado.hidden? caretUp : caretDown " ></fa-icon></button>
                    <span class="fw-bold">Certificado N°: {{i+1}} </span>
                    <span class="float-end px-2 registerCodeInHeader badge bg-secondary" > {{ certificado.registroCertificado }}</span>
                </div>
                <div class="form-group  card-body" *ngIf="!certificado.hidden" >
                    <div class="row">
                        <div class="col-md-4 col-sm-12">
                            <label [for]="'registroCertificado'+i" class="mb-1">Registro</label>
                            <div [id]="'registroCertificado'+i" class="form-control mb-2" >
                                {{ certificado.registroCertificado }}
                            </div>
                        </div>
                        <div class="col-md-8 col-sm-12">
                            <label [for]="'nombre'+i" class="mb-1">Nombre</label>
                            <div [id]="'nombre'+i" class="form-control mb-2" >
                                {{ certificado.nombre }}
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 col-sm-12">
                            <label [for]="'rut'+i" class="mb-1">Rut</label>
                            <div [id]="'rut'+i" class="form-control mb-2" >
                                {{ certificado.rut }}
                            </div>
                        </div>
                        <div class="col-md-8 col-sm-12">
                            <label [for]="'empresa'+i" class="mb-1">Empresa</label>
                            <div [id]="'empresa'+i" class="form-control mb-2" >
                                {{ certificado.empresa }}
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 col-sm-12">
                            <label [for]="'formato'+i" class="mb-1 fw-bold">Formato</label>
                            <div [id]="'formato'+i" class="form-control mb-2" >
                                {{ certificado.formato }}
                            </div>
                        </div>
                        <div class="col-md-8 col-sm-12">
                            <label [for]="'equipoCargo'+i" class="mb-1">Equipo / Cargo</label>
                            <div [id]="'equipoCargo'+i" class="form-control mb-2" >
                                {{ certificado.equipoCargo }}
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 col-sm-12">
                            <label [for]="'capacidad'+i" class="mb-1">Capacidad</label>
                            <div [id]="'capacidad'+i" class="form-control mb-2" >
                                {{ certificado.capacidad }}
                            </div>
                        </div>
                        <div class="col-md-8 col-sm-12">
                            <label [for]="'resultado'+i" class="mb-1">Resultado Evaluación</label>
                            <div [id]="'resultado'+i" class="form-control mb-2" >
                                {{ certificado.resultadoEvaluacion }}
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 col-sm-12">
                            <label [for]="'fechaCapacitacion'+i" class="mb-1">Fecha Capacitación</label>
                            <div [id]="'fechaCapacitacion'+i" class="form-control mb-2" >
                                {{certificado.fechaCapacitacion ? (certificado.fechaCapacitacion | date: 'dd/MM/yyyy'): '-' }}
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-12">
                            <label [for]="'fechaCertificacion'+i" class="mb-1">Fecha Certificación</label>
                            <div [id]="'fechaCertificacion'+i" class="form-control mb-2" >
                                {{certificado.fechaCertificacion ? (certificado.fechaCertificacion | date: 'dd/MM/yyyy' ): '-' }}
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-12">
                            <label [for]="'fechaExpiracion'+i" class="mb-1">Fecha Expiración</label>
                            <div [id]="'fechaExpiracion'+i" class="form-control mb-2" >
                                {{certificado.fechaExpiracion ? (certificado.fechaExpiracion | date: 'dd/MM/yyyy' ): '-' }} 
                            </div>
                        </div>
                   </div>
                    <div class="row">
                        <div class="col-md-4 col-sm-12">
                            <label [for]="'porcentajeTeorico'+i" class="mb-1">Teórico</label>
                            <div [id]="'porcentajeTeorico'+i" class="form-control mb-2" >
                                {{ getAsPercentage( certificado.porcentajeTeorico ) }}
                            </div>
    
                        </div>
                        <div class="col-md-4 col-sm-12">
                            <label [for]="'porcentajePractico'+i" class="mb-1">Práctico</label>
                            <div [id]="'porcentajePractico'+i" class="form-control mb-2" >
                                {{ getAsPercentage( certificado.porcentajePractico ) }}
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-12">
                            <label [for]="'porcentajeSenales'+i" class="mb-1">Señales</label>
                            <div [id]="'porcentajeSenales'+i" class="form-control mb-2" >
                                {{ certificado.porcentajeSenales ? getPercentageSenales(certificado.porcentajeSenales) : 'N/A' }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div> 

<div *ngIf="loading && certificados && certificados.length">
    <app-loading [title]="'Generando certificados...'"></app-loading>
</div>

 <ng-template #noCertificados *ngIf="!certificados || !certificados.length">
    No hay certificados para generar, compruebe que subió excel correcto
</ng-template>